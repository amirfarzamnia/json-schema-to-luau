{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/complex-test-schema.json",
  "title": "Comprehensive Test Schema",
  "description": "A complex schema with various data types and structures for testing",
  "type": "object",
  "definitions": {
    "address": {
      "type": "object",
      "required": ["street", "city", "country"],
      "properties": {
        "street": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100
        },
        "city": {
          "type": "string",
          "minLength": 1,
          "maxLength": 50
        },
        "state": {
          "type": "string",
          "minLength": 2,
          "maxLength": 2
        },
        "postalCode": {
          "type": "string",
          "pattern": "^[0-9]{5}(-[0-9]{4})?$"
        },
        "country": {
          "type": "string",
          "enum": ["US", "CA", "UK", "DE", "FR", "JP"]
        },
        "coordinates": {
          "$ref": "#/definitions/geoCoordinates"
        }
      },
      "additionalProperties": false
    },
    "geoCoordinates": {
      "type": "object",
      "required": ["latitude", "longitude"],
      "properties": {
        "latitude": {
          "type": "number",
          "minimum": -90,
          "maximum": 90
        },
        "longitude": {
          "type": "number",
          "minimum": -180,
          "maximum": 180
        },
        "elevation": {
          "type": "number",
          "description": "Elevation in meters"
        }
      },
      "additionalProperties": false
    },
    "person": {
      "type": "object",
      "required": ["firstName", "lastName", "age"],
      "properties": {
        "firstName": {
          "type": "string",
          "minLength": 1,
          "maxLength": 50
        },
        "lastName": {
          "type": "string",
          "minLength": 1,
          "maxLength": 50
        },
        "middleName": {
          "type": "string",
          "maxLength": 50
        },
        "age": {
          "type": "integer",
          "minimum": 0,
          "maximum": 150
        },
        "email": {
          "type": "string",
          "format": "email"
        },
        "phone": {
          "type": "string",
          "pattern": "^\\+?[1-9]\\d{1,14}$"
        },
        "isActive": {
          "type": "boolean",
          "default": true
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 20
          },
          "minItems": 0,
          "maxItems": 10,
          "uniqueItems": true
        }
      },
      "additionalProperties": false
    },
    "product": {
      "type": "object",
      "required": ["id", "name", "price"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[A-Z0-9]{8}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{12}$"
        },
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100
        },
        "description": {
          "type": "string",
          "maxLength": 1000
        },
        "price": {
          "type": "number",
          "exclusiveMinimum": 0
        },
        "currency": {
          "type": "string",
          "enum": ["USD", "EUR", "GBP", "JPY", "CAD"],
          "default": "USD"
        },
        "inStock": {
          "type": "boolean"
        },
        "categories": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["electronics", "clothing", "books", "home", "sports"]
          },
          "minItems": 1
        },
        "metadata": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    },
    "timestamps": {
      "type": "object",
      "properties": {
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "additionalProperties": false
    },
    "extraPayload": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "enum": ["analytics", "metrics", "events", "logs"]
        },
        "value": {
          "type": "number",
          "multipleOf": 0.5
        },
        "data": {}
      },
      "required": ["kind"],
      "additionalProperties": false
    },
    "dimensions": {
      "type": "object",
      "properties": {
        "width": {
          "type": "number",
          "minimum": 0
        },
        "height": {
          "type": "number",
          "minimum": 0
        },
        "depth": {
          "type": "number",
          "minimum": 0
        },
        "unit": {
          "type": "string",
          "enum": ["cm", "m", "in", "ft"],
          "default": "cm"
        }
      },
      "additionalProperties": false
    },
    "enhancedDimensions": {
      "allOf": [
        { "$ref": "#/definitions/dimensions" },
        {
          "type": "object",
          "properties": {
            "weight": {
              "type": "number",
              "minimum": 0
            },
            "weightUnit": {
              "type": "string",
              "enum": ["kg", "lb", "g"],
              "default": "kg"
            }
          },
          "additionalProperties": false
        }
      ]
    }
  },
  "required": [
    "id",
    "name",
    "version",
    "createdAt",
    "active",
    "primaryUser",
    "products"
  ],
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for the entity"
    },
    "name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "pattern": "^[a-zA-Z0-9 _-]+$"
    },
    "description": {
      "type": "string",
      "maxLength": 500
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["1.0.0", "2.1.3"]
    },
    "createdAt": {
      "type": "string",
      "format": "date-time"
    },
    "updatedAt": {
      "type": "string",
      "format": "date-time"
    },
    "active": {
      "type": "boolean",
      "default": false
    },
    "activationDate": {
      "type": "string",
      "format": "date-time",
      "description": "Required when active is true"
    },
    "deactivationReason": {
      "type": "string",
      "maxLength": 200,
      "description": "Required when active is false"
    },
    "suspensionReason": {
      "type": "string",
      "minLength": 1,
      "maxLength": 200,
      "description": "Required when status is suspended"
    },
    "priority": {
      "type": "integer",
      "enum": [1, 2, 3, 4, 5],
      "default": 3
    },
    "score": {
      "type": "number",
      "minimum": 0,
      "maximum": 100,
      "multipleOf": 0.5
    },
    "primaryUser": {
      "$ref": "#/definitions/person"
    },
    "secondaryUsers": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/person"
      },
      "minItems": 0,
      "maxItems": 10
    },
    "billingAddress": {
      "$ref": "#/definitions/address"
    },
    "shippingAddress": {
      "$ref": "#/definitions/address"
    },
    "products": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/product"
      },
      "minItems": 1,
      "maxItems": 100
    },
    "settings": {
      "type": "object",
      "properties": {
        "notifications": {
          "type": "object",
          "properties": {
            "email": {
              "type": "boolean",
              "default": true
            },
            "sms": {
              "type": "boolean",
              "default": false
            },
            "push": {
              "type": "boolean",
              "default": true
            }
          },
          "additionalProperties": false
        },
        "privacy": {
          "type": "object",
          "properties": {
            "level": {
              "type": "string",
              "enum": ["public", "private", "hidden"],
              "default": "private"
            },
            "shareAnalytics": {
              "type": "boolean",
              "default": false
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 20
      },
      "uniqueItems": true,
      "maxItems": 50
    },
    "metadata": {
      "type": "object",
      "additionalProperties": true,
      "description": "Flexible key-value store for additional data"
    },
    "status": {
      "type": "string",
      "enum": ["pending", "active", "suspended", "terminated"],
      "default": "pending"
    },
    "flags": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": ["featured", "verified", "premium", "legacy"]
      },
      "uniqueItems": true
    },
    "dimensions": {
      "$ref": "#/definitions/dimensions"
    },
    "enhancedDimensions": {
      "$ref": "#/definitions/enhancedDimensions"
    },
    "timestamps": {
      "type": "object",
      "additionalProperties": {
        "type": "string",
        "format": "date-time"
      }
    },
    "complexArray": {
      "type": "array",
      "items": {
        "oneOf": [
          {
            "type": "string"
          },
          {
            "type": "number"
          },
          {
            "type": "boolean"
          },
          {
            "type": "object",
            "properties": {
              "type": {
                "type": "string"
              },
              "value": {}
            }
          }
        ]
      }
    },
    "anyOfExample": {
      "anyOf": [
        {
          "type": "string",
          "pattern": "^[A-Z]+$"
        },
        {
          "type": "integer",
          "minimum": 0
        },
        {
          "type": "boolean"
        }
      ]
    },
    "allOfExample": {
      "allOf": [
        {
          "type": "object",
          "properties": {
            "name": {
              "type": "string"
            }
          },
          "required": ["name"]
        },
        {
          "type": "object",
          "properties": {
            "code": {
              "type": "string"
            }
          },
          "required": ["code"]
        }
      ]
    },
    "numericId": {
      "type": "integer",
      "minimum": 1,
      "maximum": 999,
      "description": "Alternative numeric identifier"
    },
    "compactStatus": {
      "enum": ["active", "paused", "deleted"],
      "description": "Simplified status enum"
    },
    "compactScore": {
      "enum": [1, 2, 3],
      "description": "Simplified score enum"
    },
    "enhancedMeta": {
      "type": "object",
      "allOf": [
        {
          "type": "object",
          "properties": {
            "version": {
              "type": "string",
              "pattern": "^v[0-9]+$",
              "examples": ["v1", "v2", "v10"]
            }
          },
          "required": ["version"]
        },
        { "$ref": "#/definitions/timestamps" }
      ],
      "properties": {
        "author": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "maxLength": 200
        }
      },
      "required": ["author", "version"],
      "additionalProperties": false
    },
    "compactTags": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 20
      },
      "minItems": 1,
      "maxItems": 5,
      "uniqueItems": true
    },
    "flexiblePayload": {
      "anyOf": [
        {
          "type": "string",
          "maxLength": 500
        },
        {
          "type": "number",
          "minimum": 0
        },
        {
          "$ref": "#/definitions/extraPayload"
        }
      ]
    },
    "exclusiveChoice": {
      "oneOf": [
        {
          "const": "a",
          "description": "Option A"
        },
        {
          "const": "b",
          "description": "Option B"
        },
        {
          "const": "c",
          "description": "Option C"
        }
      ]
    },
    "numericConfig": {
      "type": "object",
      "additionalProperties": {
        "type": "number",
        "minimum": 0
      },
      "maxProperties": 10
    },
    "nullableField": {
      "type": ["string", "null"],
      "description": "String field that can be explicitly set to null"
    }
  },
  "additionalProperties": false,
  "dependentRequired": {
    "billingAddress": ["primaryUser"],
    "secondaryUsers": ["primaryUser"],
    "numericId": ["id"]
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "active": { "const": true }
        },
        "required": ["active"]
      },
      "then": {
        "required": ["activationDate"]
      },
      "else": {
        "required": ["deactivationReason"]
      }
    },
    {
      "if": {
        "properties": {
          "status": { "const": "suspended" }
        },
        "required": ["status"]
      },
      "then": {
        "required": ["suspensionReason"]
      }
    }
  ]
}
